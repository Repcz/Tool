# å®˜æ–¹æ–‡æ¡£ï¼šhttps://book.egernapp.com
#
# Author:https://github.com/Repcz
# TG:https://t.me/QVQ_Channel
# ä»¥ ';' æˆ– '#' æˆ– '//' å¼€å¤´çš„é…ç½®æ–‡ä»¶è¡Œä¸ºæ³¨é‡Šè¡Œ
#
# æœ€åæ›´æ–°æ—¶é—´: 2023/12/11
#
# ================

# TUNæ¨¡å¼
vif_only: true

# é…ç½®ä¸ºä¸€ä¸ª DNS æœåŠ¡å™¨åœ°å€çš„æ•°ç»„ï¼Œè¿™äº›åœ°å€å¯ä»¥æ˜¯ IPv4 æˆ– IPv6 åœ°å€ï¼Œä¹Ÿå¯ä»¥æ˜¯ "system" æ¥ä½¿ç”¨ç³»ç»Ÿ DNS æœåŠ¡å™¨ã€‚
dns_servers:  # DNSæœåŠ¡å™¨
- 119.29.29.29
- 233.5.5.5

# ä¸ºç‰¹å®šçš„ä¸»æœºåæŒ‡å®š IP åœ°å€æˆ–å…¶ä»–ä¸»æœºåï¼Œä»¥è¦†ç›– DNS æŸ¥è¯¢çš„ç»“æœ
hosts:        # DNSæ˜ å°„
  "dns.alidns.com": "223.5.5.5" # https://dns.alidns.com/dns-query
  "doh.pub": "1.12.12.12"       # https://doh.pub/dns-query
  "dot.pub": "1.12.12.12"       # dot.pub:853

# Egern å°†ä»…ä½¿ç”¨ dns_servers ä¸­çš„ DNS æœåŠ¡å™¨æ¥è§£æ SecureDns ä¸­ servers å­—æ®µçš„åŸŸåã€‚
# æ‰€æœ‰å…¶ä»– DNS æŸ¥è¯¢å°†é€šè¿‡ SecureDns ä¸­é…ç½®çš„å®‰å…¨ DNS æœåŠ¡å™¨è¿›è¡Œã€‚
secure_dns:   # å®‰å…¨çš„DNS
  servers:    # æ”¯æŒ DoHï¼ˆä»¥ https:// å¼€å¤´ï¼‰ã€DoTï¼ˆä»¥ tls:// å¼€å¤´ï¼‰å’Œ DoQï¼ˆä»¥ quic:// å¼€å¤´ï¼‰
  - https://dns.alidns.com/dns-query
  ecs: false  # æ˜¯å¦å¯ç”¨ EDNS å®¢æˆ·ç«¯å­ç½‘ (ECS)
  public_ip_lookup_url: ''      # å…¬ç½‘ IP æŸ¥æ‰¾ URLã€‚è¿™ä¸ª URL å¿…é¡»è¿”å›è®¾å¤‡çš„å…¬ç½‘ IP åœ°å€ã€‚

policy_groups:
- select:
    name: å›½å¤–ç½‘ç«™
    policies:
    - ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹
    - ğŸ‡ºğŸ‡¸ ç¾å›½èŠ‚ç‚¹
    - ğŸ‡¸ğŸ‡¬ ç‹®åŸèŠ‚ç‚¹
    - ğŸ‡¯ğŸ‡µ æ—¥æœ¬èŠ‚ç‚¹
    - ğŸ‡¨ğŸ‡³ å°æ¹¾èŠ‚ç‚¹
    - æ‰‹åŠ¨é€‰æ‹©
- select:
    name: å›½é™…åª’ä½“
    policies:
    - ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹
    - ğŸ‡ºğŸ‡¸ ç¾å›½èŠ‚ç‚¹
    - ğŸ‡¸ğŸ‡¬ ç‹®åŸèŠ‚ç‚¹
    - ğŸ‡¯ğŸ‡µ æ—¥æœ¬èŠ‚ç‚¹
    - ğŸ‡¨ğŸ‡³ å°æ¹¾èŠ‚ç‚¹
    - æ‰‹åŠ¨é€‰æ‹©
- select:
    name: è‹¹æœæœåŠ¡
    policies:
    - DIRECT
    - ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹
    - ğŸ‡ºğŸ‡¸ ç¾å›½èŠ‚ç‚¹
    - ğŸ‡¸ğŸ‡¬ ç‹®åŸèŠ‚ç‚¹
    - ğŸ‡¯ğŸ‡µ æ—¥æœ¬èŠ‚ç‚¹
    - ğŸ‡¨ğŸ‡³ å°æ¹¾èŠ‚ç‚¹
    - æ‰‹åŠ¨é€‰æ‹©
- select:
    name: å¾®è½¯æœåŠ¡
    policies:
    - ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹
    - ğŸ‡ºğŸ‡¸ ç¾å›½èŠ‚ç‚¹
    - ğŸ‡¸ğŸ‡¬ ç‹®åŸèŠ‚ç‚¹
    - ğŸ‡¯ğŸ‡µ æ—¥æœ¬èŠ‚ç‚¹
    - ğŸ‡¨ğŸ‡³ å°æ¹¾èŠ‚ç‚¹
    - æ‰‹åŠ¨é€‰æ‹©
- select:
    name: è°·æ­ŒæœåŠ¡
    policies:
    - ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹
    - ğŸ‡ºğŸ‡¸ ç¾å›½èŠ‚ç‚¹
    - ğŸ‡¸ğŸ‡¬ ç‹®åŸèŠ‚ç‚¹
    - ğŸ‡¯ğŸ‡µ æ—¥æœ¬èŠ‚ç‚¹
    - ğŸ‡¨ğŸ‡³ å°æ¹¾èŠ‚ç‚¹
    - æ‰‹åŠ¨é€‰æ‹©
- select:
    name: æ¨ç‰¹æ¶ˆæ¯
    policies:
    - ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹
    - ğŸ‡ºğŸ‡¸ ç¾å›½èŠ‚ç‚¹
    - ğŸ‡¸ğŸ‡¬ ç‹®åŸèŠ‚ç‚¹
    - ğŸ‡¯ğŸ‡µ æ—¥æœ¬èŠ‚ç‚¹
    - ğŸ‡¨ğŸ‡³ å°æ¹¾èŠ‚ç‚¹
    - æ‰‹åŠ¨é€‰æ‹©
- select:
    name: ç”µæŠ¥æ¶ˆæ¯
    policies:
    - ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹
    - ğŸ‡ºğŸ‡¸ ç¾å›½èŠ‚ç‚¹
    - ğŸ‡¸ğŸ‡¬ ç‹®åŸèŠ‚ç‚¹
    - ğŸ‡¯ğŸ‡µ æ—¥æœ¬èŠ‚ç‚¹
    - ğŸ‡¨ğŸ‡³ å°æ¹¾èŠ‚ç‚¹
    - æ‰‹åŠ¨é€‰æ‹©
- select:
    name: OpenAI
    policies:
    - ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹
    - ğŸ‡ºğŸ‡¸ ç¾å›½èŠ‚ç‚¹
    - ğŸ‡¸ğŸ‡¬ ç‹®åŸèŠ‚ç‚¹
    - ğŸ‡¯ğŸ‡µ æ—¥æœ¬èŠ‚ç‚¹
    - ğŸ‡¨ğŸ‡³ å°æ¹¾èŠ‚ç‚¹
    - æ‰‹åŠ¨é€‰æ‹©
- select:
    name: å“”å“©å“”å“©
    policies:
    - DIRECT
    - ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹
    - ğŸ‡¨ğŸ‡³ å°æ¹¾èŠ‚ç‚¹
- select:
    name: å¹¿å‘Šæ‹¦æˆª
    policies:
    - REJECT
    - DIRECT
- select:
    name: å…œåº•åˆ†æµ
    policies:
    - ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹
    - ğŸ‡ºğŸ‡¸ ç¾å›½èŠ‚ç‚¹
    - ğŸ‡¸ğŸ‡¬ ç‹®åŸèŠ‚ç‚¹
    - ğŸ‡¯ğŸ‡µ æ—¥æœ¬èŠ‚ç‚¹
    - ğŸ‡¨ğŸ‡³ å°æ¹¾èŠ‚ç‚¹
    - æ‰‹åŠ¨é€‰æ‹©
- auto_test:
    name: ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹
    policies:
    - æ‰‹åŠ¨é€‰æ‹©
    flatten: true
    filter: ^(?=.*((?i)ğŸ‡­ğŸ‡°|é¦™æ¸¯|(\b(HK|Hong)\b)))(?!.*((?i)å›å›½|æ ¡å›­|æ¸¸æˆ|(\b(GAME)\b))).*$
    tolerance: 50
- auto_test:
    name: ğŸ‡ºğŸ‡¸ ç¾å›½èŠ‚ç‚¹
    policies:
    - æ‰‹åŠ¨é€‰æ‹©
    flatten: true
    filter: ^(?=.*((?i)ğŸ‡ºğŸ‡¸|ç¾å›½|æ³¢ç‰¹å…°|è¾¾æ‹‰æ–¯|ä¿„å‹’å†ˆ|å‡¤å‡°åŸ|è´¹åˆ©è’™|ç¡…è°·|æ‹‰æ–¯ç»´åŠ æ–¯|æ´›æ‰çŸ¶|åœ£ä½•å¡|åœ£å…‹æ‹‰æ‹‰|è¥¿é›…å›¾|èŠåŠ å“¥|(\b(US|United States)\b)))(?!.*((?i)å›å›½|æ ¡å›­|æ¸¸æˆ|(\b(GAME)\b))).*$
    tolerance: 50
- auto_test:
    name: ğŸ‡¸ğŸ‡¬ ç‹®åŸèŠ‚ç‚¹
    policies:
    - æ‰‹åŠ¨é€‰æ‹©
    flatten: true
    filter: ^(?=.*((?i)ğŸ‡¸ğŸ‡¬|æ–°åŠ å¡|ç‹®|(\b(SG|Singapore)\b)))(?!.*((?i)å›å›½|æ ¡å›­|æ¸¸æˆ|(\b(GAME)\b))).*$
    tolerance: 50
- auto_test:
    name: ğŸ‡¯ğŸ‡µ æ—¥æœ¬èŠ‚ç‚¹
    policies:
    - æ‰‹åŠ¨é€‰æ‹©
    flatten: true
    filter: ^(?=.*((?i)ğŸ‡¯ğŸ‡µ|æ—¥æœ¬|å·æ—¥|ä¸œäº¬|å¤§é˜ª|æ³‰æ—¥|åŸ¼ç‰|(\b(JP|Japan)\b)))(?!.*((?i)å›å›½|æ ¡å›­|æ¸¸æˆ|(\b(GAME)\b))).*$
    tolerance: 50
- auto_test:
    name: ğŸ‡¨ğŸ‡³ å°æ¹¾èŠ‚ç‚¹
    policies:
    - æ‰‹åŠ¨é€‰æ‹©
    flatten: true
    filter: ^(?=.*((?i)ğŸ‡¹ğŸ‡¼|å°æ¹¾|(\b(TW|Tai|Taiwan)\b)))(?!.*((?i)å›å›½|æ ¡å›­|æ¸¸æˆ|(\b(GAME)\b))).*$
    tolerance: 50
- external:
    name: æ‰‹åŠ¨é€‰æ‹©
    type: select
    urls:
    - http://your-service-provider
    hidden: false

rules:
- rule_set:
    match: https://github.com/Repcz/Tool/raw/X/Egern/Rules/APNs.yaml
    policy: DIRECT
- rule_set:
    match: https://github.com/Repcz/Tool/raw/X/Egern/Rules/Ads_ConnersHua.yaml
    policy: å¹¿å‘Šæ‹¦æˆª
- rule_set:
    match: https://github.com/Repcz/Tool/raw/X/Egern/Rules/Hijacking_ConnersHua.yaml
    policy: å¹¿å‘Šæ‹¦æˆª
- rule_set:
    match: https://github.com/Repcz/Tool/raw/X/Egern/Rules/Tracking_ConnersHua.yaml
    policy: å¹¿å‘Šæ‹¦æˆª
- rule_set:
    match: https://github.com/Repcz/Tool/raw/X/Egern/Rules/OpenAI.yaml
    policy: OpenAI
- rule_set:
    match: https://github.com/Repcz/Tool/raw/X/Egern/Rules/Apple.yaml
    policy: è‹¹æœæœåŠ¡
- rule_set:
    match: https://github.com/Repcz/Tool/raw/X/Egern/Rules/Github.yaml
    policy: å¾®è½¯æœåŠ¡
- rule_set:
    match: https://github.com/Repcz/Tool/raw/X/Egern/Rules/OneDrive.yaml
    policy: å¾®è½¯æœåŠ¡
- rule_set:
    match: https://github.com/Repcz/Tool/raw/X/Egern/Rules/Microsoft.yaml
    policy: å¾®è½¯æœåŠ¡
- rule_set:
    match: https://github.com/Repcz/Tool/raw/X/Egern/Rules/YouTube.yaml
    policy: è°·æ­ŒæœåŠ¡
- rule_set:
    match: https://github.com/Repcz/Tool/raw/X/Egern/Rules/Google.yaml
    policy: è°·æ­ŒæœåŠ¡
- rule_set:
    match: https://github.com/Repcz/Tool/raw/X/Egern/Rules/Telegram.yaml
    policy: ç”µæŠ¥æ¶ˆæ¯
- rule_set:
    match: https://github.com/Repcz/Tool/raw/X/Egern/Rules/Twitter.yaml
    policy: æ¨ç‰¹æ¶ˆæ¯
- rule_set:
    match: https://github.com/Repcz/Tool/raw/X/Egern/Rules/ProxyMedia.yaml
    policy: å›½é™…åª’ä½“
- rule_set:
    match: https://github.com/Repcz/Tool/raw/X/Egern/Rules/ProxyGFW.yaml
    policy: å›½å¤–ç½‘ç«™
- rule_set:
    match: https://github.com/Repcz/Tool/raw/X/Egern/Rules/Bilibili.yaml
    policy: å“”å“©å“”å“©
- rule_set:
    match: https://github.com/Repcz/Tool/raw/X/Egern/Rules/Lan.yaml
    policy: DIRECT
- geoip:
    match: CN
    policy: DIRECT
- default:
    policy: å…œåº•åˆ†æµ
mitm:
  enabled: true